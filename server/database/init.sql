-- PostgreSQL

DROP TABLE IF EXISTS friends CASCADE;
DROP TABLE IF EXISTS users CASCADE;

CREATE TABLE users (

	id INT PRIMARY KEY,
	username VARCHAR(25) NOT NULL,
	password_hash VARCHAR(60) NOT NULL,
	created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
	token VARCHAR(20),
	token_expires TIMESTAMP
);

CREATE TABLE friends (

	idFrom INTEGER NOT NULL REFERENCES users(id),
	idTo INTEGER NOT NULL REFERENCES users(id),
	since TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
	PRIMARY KEY (idFrom, idTo)
);

CREATE TABLE friends_requests (

	idFrom INTEGER NOT NULL REFERENCES users(id),
	idTo INTEGER NOT NULL REFERENCES users(id),
	atTimestamp TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
	PRIMARY KEY (idFrom, idTo)
);